library(clusterProfiler)
library(org.Hs.eg.db)

# Assuming `res` is DESeq2 results dataframe
sig_genes <- rownames(subset(res, padj < 0.05))

# Convert gene symbols to Entrez IDs
entrez_genes <- bitr(sig_genes, fromType="SYMBOL", toType="ENTREZID", OrgDb=org.Hs.eg.db)

# GO enrichment
ego <- enrichGO(gene=entrez_genes$ENTREZID, OrgDb=org.Hs.eg.db, ont="BP", pvalueCutoff=0.05)

# Dotplot
dotplot(ego)
